
<div class="container my-3">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0">Fee Reminders</h4>
    <div>
     <button class="btn btn-sm btn-outline-primary" (click)="sortReminders()">
  <i class="bi bi-arrow-down-up"></i> Sort by date
</button>

    </div>
  </div>

  <div class="row g-3">
    <div *ngFor="let r of reminders" class="col-12 col-sm-6 col-md-4">
      <div class="card h-100 clickable-card" (click)="openDetails(r)" role="button" tabindex="0">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h6 class="card-title mb-1">{{ r.studentName }}</h6>
              <small class="text-muted d-block">{{ r.className }}</small>
            </div>
            <div class="text-end">
              <span [ngClass]="statusBadgeClass(r.status)">{{ r.status }}</span>
            </div>
          </div>

          <div class="mt-3 d-flex justify-content-between align-items-end">
            <div>
              <div class="fw-semibold">₹ {{ r.amount }}</div>
              <small class="text-muted">Due: {{ formatDate(r.dueDate) }}</small>
            </div>
            <div>
              <button type="button" class="btn btn-sm btn-outline-secondary me-1" (click)="sendReminder(r); $event.stopPropagation()">
                <i class="bi bi-bell"></i> Remind
              </button>
              <button *ngIf="r.status !== 'PAID'" type="button" class="btn btn-sm btn-success" (click)="markPaid(r); $event.stopPropagation()">
                <i class="bi bi-check2-circle"></i> Mark Paid
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal (simple Angular modal) -->
  <div class="modal-backdrop fade show" *ngIf="showModal" (click)="closeModal()"></div>
  <div *ngIf="showModal" class="custom-modal d-flex align-items-center justify-content-center">
    <div class="modal-dialog modal-dialog-centered" role="document" (click)="$event.stopPropagation()">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Fee Details - {{ selected?.studentName }}</h5>
          <button type="button" class="btn-close" aria-label="Close" (click)="closeModal()"></button>
        </div>
        <div class="modal-body">
          <p><strong>Class:</strong> {{ selected?.className }}</p>
          <p><strong>Amount:</strong> ₹ {{ selected?.amount }}</p>
          <p><strong>Due Date:</strong> {{ selected?.dueDate ? formatDate(selected!.dueDate) : '-' }}</p>
          <p><strong>Status:</strong> <span [ngClass]="statusBadgeClass(selected!.status)">{{ selected?.status }}</span></p>
          <p *ngIf="selected?.notes"><strong>Note:</strong> {{ selected?.notes }}</p>
        </div>
        <div class="modal-footer">
          <button *ngIf="selected?.status !== 'PAID'" type="button" class="btn btn-success" (click)="markPaid(selected!)">Mark Paid</button>
          <button type="button" class="btn btn-outline-primary" (click)="sendReminder(selected!); closeModal()">Send Reminder</button>
          <button type="button" class="btn btn-secondary" (click)="closeModal()">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>
